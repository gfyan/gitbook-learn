# 计算机网络

### 简述一下OSI七层体系结构？

OSI（Open System Interconnect），简称开放式系统互联，我们称之为OSI参考模型，OSI定义了七层框架（物理层、数据链路层、网络层、传输层、会话层、表示层、应用层）。

- 应用层：为应用程序提供服务。
- 表示层：数据格式转化、数据加密。
- 会话层：建立、管理和维护会话。
- 传输层：实现网络不同主机上用户进程之间的数据通信。
- 网络层：提供IP地址、路由选择。
- 数据链路层：将上层数据封装成帧，通过MAC地址定位发送者、接受者，并控制数据帧的传输。
- 物理层：通过电缆、光缆传输比特流0和1.

### OSI参考模型和TCP/IP协议对应的关系。

| OSI参考模型 | TCP/IP协议 | 对应的网络协议 |
| :--- | :--- | :--- |
| 应用层 | 应用层 | HTTP、TFTP、FTP、NFS、SMTP|
| 表示层 | 应用层 | Telnet、Rlogin、SNMP |
| 会话层 | 应用层 | SMTP、DNS |
| 传输层 | 传输层 | TCP、UDP |
| 网络层 | 网络层 | IP、ICMP、ARP、PARP、AKP、UUCP |
| 数据链路层 | 数据链路层 | FDDI、PDN、SLIP、PPP |
| 物理层 | 数据链路层 | IEEE 802.1A、IEEE 802.2~IEEE 802.11 |

### 简述TCP/IP四层体系结构？

TCP/IP四层结构分别为应用层、传输层、网络层、数据链路层。

- 应用层：该层面向不同的网络应用引入了不同的应用层协议，比如基于TCP的有FTP协议、虚拟终端协议（Telnet）、超文本链接协议（HTTP），基于UDP的有NFS（网络文件协议）、DNS（主域名称系统）、TFTP（通用文件传输协议）。
- 传输层：传输控制协议（TCP）和用户数据报协议（UDP）。　　
- 网络层：IP协议。
- 数据链路层：PPP（点对点协议）。


### 什么是IP地址？

IP 地址是指互联网协议地址，是IP协议提供的一种统一的地址格式，它为互联网上的每一个网络和每一台主机分配一个逻辑地址，以此来屏蔽物理地址的差异。每个IP地址包括两个标识码（ID），网络ID和主机ID，IP地址总共分为5类分别为A、B、C、D、E。

### IP地址与MAC地址的区别？

IP地址是网络逻辑地址，一般换网络之后ip就会变，但是MAC地址是主机网卡地址，一般是不存在会变的，除非人工手动更改，但是系统重启后依旧会恢复原状，如果想永久性更改需要修改网卡配置文件。

### IPv4和IPv6有啥区别？

IPv4是互联网协议的第四版，IPv6是互联网协议的第六版，它们的区别如下：

- 长度：IPv4采用的是8位一个字节，总共四个字节分四段展示，每段采用.分隔。IPv6采用的是16位一个双字节，分八段展示，总共16个字节，每段采用：分隔。


### 什么是ICMP协议？

ICMP用于在IP主机、路由器之间传递控制消息，

> ping的工作原理就是向目标主机传出一个ICMP的请求回显数据包，并等待接收回显回应数据包。程序会按时间和成功响应的次数估算丢失数据包率（丢包率）和数据包往返时间（网络时延，Round-trip delay time）。

### 什么是TCP协议？

TCP是一个传输控制协议，是一种面向连接的、可靠的、基于字节流的传输通信协议，主要特点有如下几点。

- 面向连接。
- 点对点连接。
- 可靠的数据传输，无差错、不丢失、不重复、按顺序达到。
- 全双工通信，通信双方都设有发送缓存、接受缓存，用来临时存双方通信的数据。
- 面向字节流。

### TCP对应的应用层协议？

FTP（文件传输协议）、Telnet（虚拟终端协议）、SMTP（邮件传送协议）、HTTP（超文本协议）。

### 描述一下TCP三次握手？

三次握手其实就是指建立一个TCP连接时，需要客户端和服务器总共发送3个包，进行三次握手的主要作用就是为了确认双方的接收能力和发送能力是否正常、指定自己的初始化序列号为后面的可靠性传送做准备。实质上其实就是连接服务器指定端口，建立TCP连接，并同步连接双方的序列号和确认号，交换TCP窗口大小信息。

- 第一次握手：Client将标志位 SYN=1，随机产生一个值seq=x（ISN），并将该数据发送给Server，Client进入SYN_SENT状态。
- 第二次握手：Server收到数据包以后，由SYN=1知道Client是要建立连接请求，Server将标志位SYN、ACK置为1，同时增加一个ACKnum=x+1，并且Server自己生产一个seq=y（ISN序列号）进行返回，Server进入SYC_RCVD状态。
- 第三次握手：收到Server端的数据后对数据进行校验，校验成功之后将ACK置为1、ACKnum置为y+1，并进行返回，至此Client进入ESTABLISHED状态，Server收到数据后进行数据检查，校验成功Server进入ESTABLISHED状态，连接建立完成。


### 什么是SYN攻击？如何解决？

大量客户端发送连接请求，像服务端发送SYN信号，等到服务端返回SYN、ACK数据后，客户端不进行第三次确认，一直等待中，导致服务端堆积很多的半连接状态的TCP连接，最终导致服务不可用。

**如何检测SYN攻击，可以使用netstat命令进行查看，查看当前是否存在大量半连接状态的TCP连接，特别是源IP都是随机的，如果存在这种情况表示当前为SYN攻击。**

**如何预防SYN攻击：**

- 限制同时打开SYN半连接数量（慎重考虑，有可能导致本身高并发服务性能的损耗）
- 缩短SYN半连接超时的时间。
- 增大半连接最大数量。
- SYN cookie技术。

### 什么是 TCP 四次挥手？

四次挥手表示一个正常的TCP连接需要断开的情况下，需要客户端和服务端总共发送4个包。

- 第一次挥手：Client发送一个FIN报文，fin=序列号，用来关闭Client到Server的数据传送，此时Client进入FIN_WAIT_1状态。
- 第二次挥手：Server收到FIN报文的时候，会发送ack报文，把客户端的序列号+1作为ack报文数据，表示已经明确收到Client的fin数据包了，确认报文（ACK、ack=序列号+1、seq=序列号）发送后，服务端进入CLOSE_WAIT状态，客户端收到确认报文后进入FIN_WAIT_2状态，等待服务端发送关闭信号。
- 第三次挥手：Server端发送FIN关闭报文，fin=序列号，报文发出后Server变为LAST_ACK状态。
- 第四次挥手：Client收到Server的FIN报文后，一样发送一个ACK报文（ACK、ack=序列号+1、seq=序列号），此时Client还没关闭处于TIME_WAIT状态，Client需要等待2MSL这个时间段如果没有重发的FIN报文则直接进入CLOSED状态，而Server端收到ACK报文后直接进入CLOSED状态。

### TCP数据如何传输？

加入A、B两台机器建立了TCP连接，这个时候A需要像B传输300字节的数据，传输过程如下：

1. 首先主机A发送一个数据包，数据包大小为100字节，数据包中有一个序列号x。
2. 主机B收到数据包后，对数据进行读取，读取完毕后将数据包中的序列号x+100字节（假设完整接受）+1，将x+100+1封装在ACK数据包中进行发出。
3. 主机A收到ACK后，确认ACK数据包是否正确，如果错误则进行重传，如果成功进行下一个数据包传输。

### UDP是什么？

UDP（User Data Protocol，用户数据报协议），是与TCP相对应的协议。它是面向非连接的协议，它不与对方建立连接，而是直接就把数据包发送过去。

### TCP和UDP的区别？
- TCP是面向连接的，UDP是无连接的。
- TCP具有可靠性，UDP则不具有。
- TCP只支持点对点通信，UDP支持一对一、一对多、多对一、多对多。
- TCP是面向字节流的，UDP是面向报文的，流模式是发送方可以write多次，但是接受方可以read一次，报文则不是，一次报文发送对应一次报文读取。
- TCP首部开销比UDP开销大，TCP多了序列号、确认号、校验数据以及窗口数据等等。

### DNS是什么？

DNS具有域名解析作用，将www.xxx.com 转换成 IP ，能够使用户更方便的访问互联网，而不用去记住能够被机器直接读取的IP数串。
DNS协议运行在UDP协议之上，使用端口号53。

### 主机解析域名的顺序？

1. 浏览器缓存
2. 找本机的 hosts 文件
3. 路由缓存
4. 找DNS服务器(本地域名、顶级域名、根域名)

### HTTP是什么？

HTTP 协议，是Hyper Text Transfer Protocol（超文本传输协议）的缩写，是用于从万维网（World Wide Web ）服务器传输超文本到本地浏览器的传送协议。

**特点：**

- 简单快速：客户向服务器请求服务时，只需传送请求方法和路径。请求方法常用的有 GET、HEAD、POST 等等。每种方法规定了客户与服务器联系的类型不同。由于 HTTP 协议简单，使得 HTTP 服务器的程序规模小，因而通信速度很快。
- 数据格式灵活：HTTP 允许传输任意类型的数据对象。正在传输的类型由Content-Type 加以标记。
- 无状态：无状态的含义是限制每次连接只处理一个请求。服务器处理完客户的请求，并收到客户的应答后，即断开连接。采用这种方式可以节省传输时间。

### HTTP的请求基本格式？

- 请求行：用来说明请求类型，要访问的资源以及所使用的 HTTP 版本。
- 请求头部：紧接着请求行（即第一行）之后的部分，用来说明服务器要使用的附加信息从第二行起为请求头部。
- 空行：请求头部后面的空行是必须的。
- 请求数据：也叫主体，可以添加任意的其他数据。


### GET和POST的区别？

- GET请求的参数是放在URL上面的，在请求的path上，但是POST是在body中。
- 数据安全，POST要比GET更加安全。
- 长度限制，GET限制2k，POST无限制。
- 应用场景，GET用于查询数据，POST用于提交或者修改数据。

### HTTP有哪些状态码？

- 200 Http请求成功。
- 301 永久重定向，使用域名跳转。
- 302 临时重定向，未登陆的用户访问用户中心重定向到登录页面。
- 400 客户端请求有语法错误，不能被服务器所理解。
- 401 请求未经授权，这个状态代码必须和WWW-Authenticate报头域一起使用。
- 403 服务器收到请求，但是拒绝提供服务。
- 404 请求资源不存在，eg：输入了错误的URL。
- 500 服务器发生不可预期的错误。
- 503 服务器当前不能处理客户端的请求，一段时间后可能恢复正常。

### Forward 和 Redirect 的区别？

- 直接转发方式（Forward），客户端和浏览器只发出一次请求，Servlet、HTML、JSP 或其它信息资源，由第二个信息资源响应该请求，在请求对象 request 中，保存的对象对于每个信息资源是共享的。
- 间接转发方式（Redirect），实际是两次 HTTP 请求，服务器端在响应第一次请求的时候，让浏览器再向另外一个 URL 发出请求，从而达到转发的目的。

### HTTP1.0 和 HTTP1.1 有什么区别？

- 1.1支持长连接。
- 带宽优化（支持只发送header信息，如果服务器认可有权限之后则返回100，客户端会再次将body数据直接发送到服务器）。
- HOST域。

### HTTP1.1 和 HTTP2 有什么区别？

- 多路复用，同一个连接并发处理多个请求，也可以建立多个连接多个并发请求共用这些连接。
- 数据压缩，HTTP1.1不支持header数据的压缩，HTTP2.0使用HPACK算法对header的数据进行压缩，这样数据体积小了，在网络上传输就会更快。
- 服务器推送，意思是说，当我们对支持HTTP2.0的web server请求数据的时候，服务器会顺便把一些客户端需要的资源一起推送到客户端，免得客户端再次创建连接发送请求到服务器端获取。这种方式非常合适加载静态资源。

### HTTPS是什么？

HTTPS ，实际就是在 TCP 层与 HTTP 层之间加入了 SSL/TLS 来为上层的安全保驾护航，主要用到对称加密、非对称加密、证书，等技术进行客户端与服务器的数据加密传输，最终达到保证整个通信的安全性。






